CREATE DATABASE IF NOT EXISTS PreisaVacaciones;
USE PreisaVacaciones;
DROP TABLE empleados

-- Tabla de empleados
CREATE TABLE empleados (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    password VARCHAR(255) NOT NULL,
    puesto VARCHAR(100) NOT NULL,
    fecha_ingreso DATE NOT NULL
    rol ENUM('admin', 'editor', 'usuario') NOT NULL DEFAULT 'usuario';
);

-- Insertar datos de prueba
--INSERT INTO empleados (nombre, puesto, fecha_ingreso) VALUES 
--('Juan Perez', 'OPERADOR FUNERARIO', '2021-03-15');



CREATE TABLE vacaciones (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_empleado INT NOT NULL,
    dias_totales INT NOT NULL,
    dias_asignados INT NOT NULL,
    dias_disfrutados INT NOT NULL,
    FOREIGN KEY (id_empleado) REFERENCES empleados(id)
    ON DELETE CASCADE
);

-- Luego inserta de nuevo tus datos
--INSERT INTO vacaciones (id_empleado, dias_totales, dias_asignados, dias_disfrutados)
--VALUES (1, 20, 6, 0);

DROP TABLE solicitudes;

CREATE TABLE solicitudes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_empleado INT NOT NULL,
    fecha_inicio DATE NOT NULL,
    fecha_fin DATE NOT NULL,
    dias_solicitados INT NOT NULL,
    estado ENUM('pendiente', 'aprobada', 'rechazada') DEFAULT 'pendiente',
    fecha_aprobacion DATETIME NULL,
    FOREIGN KEY (id_empleado) REFERENCES empleados(id)
    
);
CREATE TABLE rechazos_vacaciones (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_solicitud INT NOT NULL,
    motivo TEXT NOT NULL,
    fecha_rechazo DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id_solicitud) REFERENCES solicitudes(id)
);
CREATE TABLE vacaciones_disfrutadas (
     id INT AUTO_INCREMENT PRIMARY KEY,
     id_solicitud INT NOT NULL,
     fecha_procesamiento DATETIME NOT NULL,
     FOREIGN KEY (id_solicitud) REFERENCES solicitudes(id)
 );